---
title: "Aggregating Anteaters Project"
output: 
  html_document:
    number_sections: true
date: "2023-11-16"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE, # (JMEP) makes sure html doc doesn't print warnings
                      message = FALSE) # (JMEP) makes sure html doc doesn't print messages
```
```{r}
library(tidyverse)
library(GGally) # (JMEP lib to make pretty pairs panel)
library(ggplot2)
source("https://edin.ac/4616rYu")
get_my_data(group_name = "aggregating_anteaters")

# (JMEP) cleaning data of weird values - see notes 
emoji_clean <- emoji |>
  filter(is.na(age) == F,
         age > 2,
         opsys != "windows",
         em_cat != "upside-down face",
         freq_emu >= 0) |>
  mutate(opsys = ifelse(opsys == "appple", "apple", opsys),
         opsys = as.factor(opsys))
```


# Data Description

```{r}
# (JMEP) pretty paris panel
emoji_clean |> 
  select(age, freq_emu, EVS) |> 
  ggpairs()
```
# Meg - 1c chisq tests and balance ----
```{r}
chisq.test(table(emoji_clean$opsys, emoji_clean$em_cat))
# so there is no significant association between which operating system you use and your  emoji category
# but is there a balance? 
# the null hyp would state that each emoji should be presented with the same frequencies
# but the table shows us that apple was more frequently shown each type of emoji than android
```
```{r}
# so we can build a mosaic plot to represent expected vs observed levels of each emoji being presented
emoji_clean |>
  select(opsys, em_cat) |>
  table() |>
  addmargins()
# a beautiful contingency table
t <- emoji_clean |>
  select(opsys, em_cat) |>
  table()
t
# now we add expected values
e <- rowSums(t) %o%
  colSums(t)/sum(t)
e
```
```{r}
# plot
plot(t)
```
```{r}
#plot
plot(as.table(e))

```
I DON'T KNOW IF THIS IS WHAT 1C WAS ASKING BUT THE DIFFERENT PLOTS SEEM TO ANSWER THE QUESTION 'IS THERE A BALANCE'

# Question 1b
# By: Renia

```{r}

cor.test(emoji_clean$age, emoji_clean$freq_emu)

mean(emoji_clean$age)
sd(emoji_clean$age)
mean(emoji_clean$freq_emu)
sd(emoji_clean$freq_emu)

ggplot(emoji_clean, aes(x=age, y=freq_emu)) + 
  geom_point() + 
  labs(x = "Age",
       y = "Frequency of emoji use per day",
       title = "Figure 1: Negative relationship between age and frequency of emoji use")+
  guides(fill="none") + 
  theme_light()
```
#Interpretation for Correlation test, Q1b:

A correlation test was conducted to assess whether there is a relationship between the age of an individual, and the frequency by which they use emoji. A total of 235 individuals where included in the analysis, with a mean age of 35.39 (SD = 13.45) and a mean frequency of use of emoji of 5.15 (SD = 5.15).
There was a strong negative correlation between a geographical age of an individual and the frequency of emoji use. (r = -0.79, t(233)= -19.35 , p < 2.2e-16). We therefore reject the null hypothesis that there is no correlation between an areaâ€™s school attendance and attainment. Figure 1 provides a visualization of the relationship.




# The Emotional Effect of Emojis

# Accuracy of Emoji Interpretation

# Appendix A: Supplementary Tables and Figures

# Notes for report (to be deleted)

found this cool way of generating lm equation :0 https://bookdown.org/yihui/rmarkdown-cookbook/equatiomatic.html

(JMEP; 16/11/2023 - midnight zoomies) found this cool way of generating lm equation :0 https://bookdown.org/yihui/rmarkdown-cookbook/equatiomatic.html

(JMEP; 16/11/2023 - midnight zoomies) Would be helpful if we could do all our code for each section in one chunk. Then we can call tables/figures where we need them and refer to numbers in inline code. Inline code example: `r mean(emoji$age)` (there is an NA in age, booo)

(JMEP; 16/11/2023 - midnight zoomies) I looked into age. There is one NA, one person who is -100 years old and one that is 1 year old. I think we can reliably remove them (done in emoji_clean). There are also a bunch (`r nrow(filter(emoji, is.na(age) == F & age < 18 & age > 1))` to be exact) that are under 18 (between `r range(filter(emoji, is.na(age) == F & age < 18 & age > 1)$age)[1]` and `r range(filter(emoji, is.na(age) == F & age < 18 & age > 1)$age)[2]`), whom I am not sure if we should remove??
I also noticed some other unusual stuff. Frequency ratings below 0, and a typo in "Apple" for one of the operating systems ("Appple"). There are also only two windows users which isn't really helpful in terms of analysis - might wanna exclude them.